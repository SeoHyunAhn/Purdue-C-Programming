0x0000000000000000: 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F 2E  #include <stdio.
0x0000000000000010: 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 72  h>.#include <str
0x0000000000000020: 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20  ing.h>.#include 
0x0000000000000030: 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69 64  <stdlib.h>..void
0x0000000000000040: 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20 2A   filedump(char *
0x0000000000000050: 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B 0A   p , int len) {.
0x0000000000000060: 20 20 20 20 0A 20 20 20 20 69 6E 74 20 63 3B 0A      .    int c;.
0x0000000000000070: 20 20 20 20 69 6E 74 20 6A 3D 30 3B 0A 20 20 20      int j=0;.   
0x0000000000000080: 20 69 6E 74 20 69 3D 30 3B 0A 20 20 20 20 69 6E   int i=0;.    in
0x0000000000000090: 74 20 61 64 64 20 3D 20 30 3B 0A 20 20 20 20 77  t add = 0;.    w
0x00000000000000A0: 68 69 6C 65 20 28 6A 20 3C 20 6C 65 6E 29 0A 20  hile (j < len). 
0x00000000000000B0: 20 20 20 7B 0A 20 20 20 20 20 20 20 20 70 72 69     {.        pri
0x00000000000000C0: 6E 74 66 28 20 22 30 78 30 30 30 30 30 30 30 30  ntf( "0x00000000
0x00000000000000D0: 30 30 25 30 35 58 30 3A 20 22 2C 61 64 64 29 3B  00%05X0: ",add);
0x00000000000000E0: 0A 20 20 20 20 20 20 20 20 61 64 64 2B 2B 3B 0A  .        add++;.
0x00000000000000F0: 20 20 20 20 20 20 20 20 66 6F 72 20 28 20 69 20          for ( i 
0x0000000000000100: 3D 20 6A 3B 20 69 20 3C 20 6C 65 6E 20 26 26 20  = j; i < len && 
0x0000000000000110: 69 20 3C 20 28 6A 20 2B 20 31 36 29 3B 20 69 20  i < (j + 16); i 
0x0000000000000120: 2B 2B 29 0A 20 20 20 20 20 20 20 20 7B 0A 20 20  ++).        {.  
0x0000000000000130: 20 20 20 20 20 20 20 20 20 20 63 20 3D 20 70 5B            c = p[
0x0000000000000140: 69 5D 26 30 78 46 46 3B 0A 20 20 20 20 20 20 20  i]&0xFF;.       
0x0000000000000150: 20 20 20 20 20 70 72 69 6E 74 66 28 20 22 25 30       printf( "%0
0x0000000000000160: 32 58 20 22 2C 20 63 29 3B 0A 20 20 20 20 20 20  2X ", c);.      
0x0000000000000170: 20 20 7D 0A 20 20 20 20 20 20 20 20 69 6E 74 20    }.        int 
0x0000000000000180: 74 65 6D 70 20 3D 20 6C 65 6E 3B 0A 20 20 20 20  temp = len;.    
0x0000000000000190: 20 20 20 20 77 68 69 6C 65 20 28 74 65 6D 70 20      while (temp 
0x00000000000001A0: 3C 20 6A 20 2B 20 31 36 29 0A 20 20 20 20 20 20  < j + 16).      
0x00000000000001B0: 20 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20    {.            
0x00000000000001C0: 74 65 6D 70 2B 2B 3B 0A 20 20 20 20 20 20 20 20  temp++;.        
0x00000000000001D0: 20 20 20 20 70 72 69 6E 74 66 28 20 22 25 73 20      printf( "%s 
0x00000000000001E0: 22 2C 20 22 20 20 22 29 3B 0A 20 20 20 20 20 20  ", "  ");.      
0x00000000000001F0: 20 20 7D 0A 20 20 20 20 20 20 20 20 70 72 69 6E    }.        prin
0x0000000000000200: 74 66 28 20 22 25 73 22 2C 20 22 20 22 29 3B 0A  tf( "%s", " ");.
0x0000000000000210: 20 20 20 20 20 20 20 20 66 6F 72 20 28 20 69 20          for ( i 
0x0000000000000220: 3D 20 6A 3B 20 69 20 3C 20 6C 65 6E 20 26 26 20  = j; i < len && 
0x0000000000000230: 69 20 3C 20 6A 20 2B 20 31 36 3B 20 69 20 2B 2B  i < j + 16; i ++
0x0000000000000240: 29 0A 20 20 20 20 20 20 20 20 7B 0A 20 20 20 20  ).        {.    
0x0000000000000250: 20 20 20 20 20 20 20 20 63 20 3D 20 70 5B 69 5D          c = p[i]
0x0000000000000260: 26 30 78 46 46 3B 0A 20 20 20 20 20 20 20 20 20  &0xFF;.         
0x0000000000000270: 20 20 20 0A 20 20 20 20 20 20 20 20 20 20 20 20     .            
0x0000000000000280: 70 72 69 6E 74 66 28 20 22 25 63 22 2C 20 28 63  printf( "%c", (c
0x0000000000000290: 3E 3D 33 32 20 26 26 20 63 20 3C 20 31 32 37 29  >=32 && c < 127)
0x00000000000002A0: 3F 63 3A 27 2E 27 29 3B 0A 20 20 20 20 20 20 20  ?c:'.');.       
0x00000000000002B0: 20 7D 0A 20 20 20 20 20 20 20 20 6A 20 2B 3D 20   }.        j += 
0x00000000000002C0: 31 36 3B 0A 20 20 20 20 20 20 20 20 70 72 69 6E  16;.        prin
0x00000000000002D0: 74 66 28 22 5C 6E 22 29 3B 0A 20 20 20 20 7D 0A  tf("\n");.    }.
0x00000000000002E0: 7D 0A 0A 0A 69 6E 74 20 6D 61 69 6E 28 69 6E 74  }...int main(int
0x00000000000002F0: 20 61 72 67 63 2C 20 63 68 61 72 20 2A 2A 61 72   argc, char **ar
0x0000000000000300: 67 76 29 20 7B 0A 20 20 20 20 69 6E 74 20 6D 61  gv) {.    int ma
0x0000000000000310: 78 62 79 74 65 3B 0A 20 20 20 20 69 6E 74 20 66  xbyte;.    int f
0x0000000000000320: 69 6C 65 53 69 7A 65 3B 0A 20 20 20 20 0A 20 20  ileSize;.    .  
0x0000000000000330: 20 20 46 49 4C 45 20 2A 66 69 6E 3D 66 6F 70 65    FILE *fin=fope
0x0000000000000340: 6E 28 61 72 67 76 5B 31 5D 2C 20 22 72 22 29 3B  n(argv[1], "r");
0x0000000000000350: 0A 20 20 20 20 0A 20 20 20 20 69 66 28 66 69 6E  .    .    if(fin
0x0000000000000360: 20 3D 3D 20 4E 55 4C 4C 29 7B 0A 20 20 20 20 20   == NULL){.     
0x0000000000000370: 20 20 20 70 72 69 6E 74 66 28 22 45 72 72 6F 72     printf("Error
0x0000000000000380: 20 6F 70 65 6E 69 6E 67 20 66 69 6C 65 20 5C 22   opening file \"
0x0000000000000390: 69 6E 76 61 6C 69 64 66 69 6C 65 5C 22 5C 6E 22  invalidfile\"\n"
0x00000000000003A0: 29 3B 0A 20 20 20 20 20 20 20 20 65 78 69 74 28  );.        exit(
0x00000000000003B0: 31 29 3B 0A 20 20 20 20 7D 0A 20 20 20 20 66 73  1);.    }.    fs
0x00000000000003C0: 65 65 6B 28 66 69 6E 2C 20 30 4C 2C 20 53 45 45  eek(fin, 0L, SEE
0x00000000000003D0: 4B 5F 45 4E 44 29 3B 20 20 2F 2F 20 47 6F 20 74  K_END);  // Go t
0x00000000000003E0: 6F 20 74 68 65 20 65 6E 64 20 6F 66 20 74 68 65  o the end of the
0x00000000000003F0: 20 66 69 6C 65 20 66 69 6E 0A 20 20 20 20 66 69   file fin.    fi
0x0000000000000400: 6C 65 53 69 7A 65 20 3D 20 66 74 65 6C 6C 28 66  leSize = ftell(f
0x0000000000000410: 69 6E 29 3B 20 2F 2F 20 47 65 74 20 63 75 72 72  in); // Get curr
0x0000000000000420: 65 6E 74 20 66 69 6C 65 20 70 6F 69 6E 74 65 72  ent file pointer
0x0000000000000430: 0A 20 20 20 20 66 73 65 65 6B 28 66 69 6E 2C 20  .    fseek(fin, 
0x0000000000000440: 30 4C 2C 20 53 45 45 4B 5F 53 45 54 29 3B 20 2F  0L, SEEK_SET); /
0x0000000000000450: 2F 20 47 6F 20 62 61 63 6B 20 74 6F 20 74 68 65  / Go back to the
0x0000000000000460: 20 62 65 67 69 6E 6E 69 6E 67 20 6F 66 20 74 68   beginning of th
0x0000000000000470: 65 20 66 69 6C 65 2E 0A 20 20 20 20 0A 20 20 20  e file..    .   
0x0000000000000480: 20 69 66 20 28 61 72 67 63 3D 3D 33 20 26 26 66   if (argc==3 &&f
0x0000000000000490: 69 6C 65 53 69 7A 65 3E 61 74 6F 69 28 61 72 67  ileSize>atoi(arg
0x00000000000004A0: 76 5B 32 5D 29 29 20 7B 0A 20 20 20 20 20 20 20  v[2])) {.       
0x00000000000004B0: 20 6D 61 78 62 79 74 65 3D 20 61 74 6F 69 28 61   maxbyte= atoi(a
0x00000000000004C0: 72 67 76 5B 32 5D 29 3B 0A 20 20 20 20 20 20 20  rgv[2]);.       
0x00000000000004D0: 20 63 68 61 72 20 2A 6E 61 6D 65 20 3D 20 28 63   char *name = (c
0x00000000000004E0: 68 61 72 20 2A 29 20 6D 61 6C 6C 6F 63 28 73 69  har *) malloc(si
0x00000000000004F0: 7A 65 6F 66 28 63 68 61 72 29 2A 31 30 30 30 30  zeof(char)*10000
0x0000000000000500: 30 29 3B 0A 20 20 20 20 20 20 20 20 66 72 65 61  0);.        frea
0x0000000000000510: 64 28 6E 61 6D 65 2C 20 6D 61 78 62 79 74 65 2C  d(name, maxbyte,
0x0000000000000520: 20 31 2C 20 66 69 6E 29 3B 0A 20 20 20 20 20 20   1, fin);.      
0x0000000000000530: 20 20 66 69 6C 65 64 75 6D 70 28 6E 61 6D 65 2C    filedump(name,
0x0000000000000540: 20 6D 61 78 62 79 74 65 29 3B 0A 20 20 20 20 20   maxbyte);.     
0x0000000000000550: 20 20 20 66 72 65 65 28 6E 61 6D 65 29 3B 0A 20     free(name);. 
0x0000000000000560: 20 20 20 7D 65 6C 73 65 20 7B 0A 20 20 20 20 20     }else {.     
0x0000000000000570: 20 20 20 63 68 61 72 20 2A 6E 61 6D 65 20 3D 20     char *name = 
0x0000000000000580: 28 63 68 61 72 20 2A 29 20 6D 61 6C 6C 6F 63 28  (char *) malloc(
0x0000000000000590: 73 69 7A 65 6F 66 28 63 68 61 72 29 2A 31 30 30  sizeof(char)*100
0x00000000000005A0: 30 30 30 29 3B 0A 20 20 20 20 20 20 20 20 66 72  000);.        fr
0x00000000000005B0: 65 61 64 28 6E 61 6D 65 2C 20 66 69 6C 65 53 69  ead(name, fileSi
0x00000000000005C0: 7A 65 2C 20 31 2C 20 66 69 6E 29 3B 0A 20 20 20  ze, 1, fin);.   
0x00000000000005D0: 20 20 20 20 20 66 69 6C 65 64 75 6D 70 28 6E 61       filedump(na
0x00000000000005E0: 6D 65 2C 20 66 69 6C 65 53 69 7A 65 29 3B 0A 20  me, fileSize);. 
0x00000000000005F0: 20 20 20 20 20 20 20 66 72 65 65 28 6E 61 6D 65         free(name
0x0000000000000600: 29 3B 0A 20 20 20 20 7D 0A 20 20 20 20 0A 7D 0A  );.    }.    .}.
0x0000000000000610: 0A 0A                                            ..
